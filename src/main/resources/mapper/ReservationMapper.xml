<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.ddu.pro.service.ReservationMapper">
  	<!-- 예약현황 전체 뽑기(페이징) -->
	<select id="getReserv">
		select * from reservation 
		where bn_id = #{bn_id}
		<if test="cri.searchName !=null and cri.searchName!=''">
		and res_name like concat ('%',#{cri.searchName},'%')
		</if>
		<if test="cri.searchPhone !=null and cri.searchPhone!=''">
		and res_phone like concat ('%',#{cri.searchPhone},'%')
		</if>
		<if test="cri.searchId !=null and cri.searchId!=''">
		and user_id like concat ('%',#{cri.searchId},'%')
		</if>
		<if test="cri.searchRoomnum !=null and cri.searchRoomnum !=''">
		and room_num like concat ('%',#{cri.searchRoomnum},'%')
		</if>
		order by res_num desc
		limit #{cri.pageStart}, #{cri.amount}
	</select>
	<!-- 예약현황 전체 뽑기(달력) -->
	<select id="getReservAll">
		select * from reservation where bn_id = #{bn_id} 
	</select>
	
	<!-- 사업자 아이디에 맞게 데이터 총 갯수 뽑기 -->
	<select id="getTotal">
		select count(*) as total from reservation where bn_id = #{bn_id}
	</select>
	
	
	<!-- 예약현황 자세히 보기 -->
	<select id="getDetailRes">
		select * from reservation where room_num = #{room_num} and res_num = #{res_num}
	</select>
	<!-- 예약 수정 -->
	<update id="updateReserv">
		update reservation set 
			room_num = 503,
			res_startdate = #{res_startdate},
			res_enddate = #{res_enddate},
			res_price = #{res_price},
			res_users = #{res_users},
			room_num = #{room_num}
			 where res_num = #{res_num}
	</update>
	<!-- 예약 삭제 -->
	<delete id="deleteReserv">
		delete from reservation where res_num = #{res_num}
	</delete>
  </mapper>